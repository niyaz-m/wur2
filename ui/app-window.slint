import { LineEdit, Button, HorizontalBox, VerticalBox, ListView } from "std-widgets.slint";

export component wur2 inherits Window {
    min-width: 400px;
    min-height: 400px;
    background: #1a1a1a;

    in-out property <[string]> history: [];
    in-out property <[string]> online_users: [];
    in-out property <string> message: "";
    callback add-to-history(string);
    callback append_message(string);

    HorizontalBox {
        padding: 10px;
        spacing: 10px;

        Rectangle {
            width: 180px;
            background: #202020;
            border-radius: 6px;

            VerticalBox {
                padding: 10px;
                spacing: 8px;

                Text {
                    text: "Online";
                    color: #d4d4d4;
                    font-size: 16px;
                }

                ListView {
                    for user in root.online_users : HorizontalBox {
                        padding: 4px;
                        Rectangle {
                            background: #2a2a2a;
                            border-radius: 4px;
                            Text {
                                text: user;
                                color: white;
                                font-size: 14px;
                            }
                        }
                    }
                }
            }
        }

        VerticalBox {
            spacing: 10px;
            horizontal-stretch: 1;

            ListView {
                for entry in root.history : HorizontalBox {
                    padding: 5px;
                    Rectangle {
                        background: #2a2a2a;
                        border-radius: 4px;
                        Text {
                            text: entry;
                            color: white;
                            font-size: 16px;
                        }
                    }
                }
            }

            HorizontalBox {
                vertical-stretch: 0;
                spacing: 10px;

                LineEdit {
                    placeholder-text: "Send a message...";
                    text <=> root.message;
                    horizontal-stretch: 1;
                    accepted => {
                        if (root.message != "") {
                            root.add-to-history(root.message);
                            root.message = "";
                        }
                    }
                }

                Button {
                    text: "Send";
                    primary: true;
                    clicked => {
                        if (root.message != "") {
                            root.add-to-history(root.message);
                            root.message = "";
                        }
                    }
                }
            }
        }
    }
}
